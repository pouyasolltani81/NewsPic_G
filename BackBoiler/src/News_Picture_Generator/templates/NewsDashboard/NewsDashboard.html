{% extends "ui/user_base.html" %}
{% load i18n %}

{% block title %}NewsDashboard –  UI{% endblock %}
{% block page_heading %}NewsDashboard{% endblock %}

{% block extra_css %}
  {{ block.super }}
{% endblock %}

{% block content %}



  <div id="main-content" class='z-10'>

    <!-- Generate new picture button -->
      <button id="generateBtn" class="mt-10 ml-10 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        Generate New Picture
      </button>

    <!-- Loading overlay -->
    {% if needs_translation %}
    <div id="translation-overlay" class="translation-overlay">
        <div class="translation-progress">
            <h3> {% trans "Translating content..." %} </h3>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <p class="progress-text">
                <span id="progress-current">0</span> / <span id="progress-total">0</span>{% trans "items translated" %} 
            </p>
        </div>
    </div>
    {% endif %}


    {# ─────────────────────── DASHBOARD TAB ─────────────────────── #}
    {% include "./partials/dashboard_section.html" %}


    {# ─────────────────────── QWEN TAB ─────────────────────── #}
    {% include "./partials/qwen_section.html" %}



    {# ─────────────────────── WHISPER TAB ─────────────────────── #}
    {% include "./partials/whisper_section.html" %}

  

  
    
     {# ─────────────────────── MESSAGES TAB ─────────────────────── #}
    {% include "./partials/messages_section.html" %}

   
  </div>
{% endblock %}

{% block extra_js %}
  {{ block.super }}
  <script>

  const navItems = [
  { key: '1', section: "dashboard", label: "{{ _('Dashboard') }}", icon: "layout-dashboard", active: true },
  { key: '2', section: "qwen", label: "{{ _('qwen') }}", icon: "brain-circuit" },
  { key: '3', section: "whisper", label: "{{ _('whisper') }}", icon: "audio-lines" },
  { key: '4', section: "messages", label: "{{ _('Messages') }}", icon: "mails" },


];


    const contentSections = {
      dashboard: document.getElementById('dashboard-content'),
      messages: document.getElementById('messages-content'),
      qwen: document.getElementById('qwen-content'),
      whisper: document.getElementById('whisper-content'),



    };

    const nav = new NavigationMain('navigationMain', navItems, contentSections);
    
    window.addEventListener('DOMContentLoaded', () => {
      window.nav = nav;
 
    
    });
</script>


<script>

  {% include "./partials/messages.js" %}
  {% include "./partials/components.js" %}
  {% include "./partials/qwen.js" %}
  {% include "./partials/whisper.js" %}




</script>


    
<style>
.translation-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.translation-progress {
    background: white;
    padding: 30px;
    border-radius: 10px;
    text-align: center;
    min-width: 300px;
}

.progress-bar-container {
    width: 100%;
    height: 20px;
    background: #f0f0f0;
    border-radius: 10px;
    margin: 20px 0;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: #4CAF50;
    width: 0%;
    transition: width 0.3s ease;
}

.progress-text {
    font-size: 14px;
    color: #666;
}

.news-title {
    transition: opacity 0.3s ease;
}

.news-title.translating {
    opacity: 0.5;
}
</style>
<script>
{% if needs_translation %}

  {% include "./partials/translate.js" %}


{% endif %}

// Preserve filter selection when changing pages
document.addEventListener('DOMContentLoaded', function() {
    const filterSelect = document.getElementById('imageFilter');
    const currentFilter = '{{ current_filter }}';
    
    if (currentFilter && filterSelect) {
        filterSelect.value = currentFilter;
    }
    
    filterSelect.addEventListener('change', function() {
        window.location.href = '?filter=' + this.value;
    });
});
</script>


{% endblock %}
